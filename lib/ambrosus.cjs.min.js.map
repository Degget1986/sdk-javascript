{"version":3,"file":"ambrosus.cjs.min.js","sources":["../src/responseHandler.js","../src/api/request.js","../src/utils.js","../src/api/assets.js","../src/api/events.js","../src/api/auth.js","../src/index.js"],"sourcesContent":["/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const handleResponse = request => {\n  return new Promise((resolve, reject) => {\n    const response = {\n      status: request.status,\n      data: null,\n      message: JSON.parse(request.response).reason\n    };\n\n    if (request.status === 200 || request.status === 201) {\n      response.data = JSON.parse(request.response);\n      response.message = 'success';\n      resolve(response);\n    }\n    reject(response);\n  });\n};\n\nexport const rejectResponse = message => {\n  return {\n    status: 400,\n    data: null,\n    message: message\n  };\n};\n\nexport const successResponse = data => {\n  return {\n    status: 200,\n    data: data,\n    message: 'success'\n  };\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport { handleResponse } from './../responseHandler';\n\nexport default class Request {\n  constructor(settings) {\n    this._settings = settings;\n  }\n\n  getRequest(path) {\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open('GET', `${this._settings.apiEndpoint}/${path}`, true);\n      request.addEventListener(\n        'load',\n        () => {\n          handleResponse(request)\n            .then(response => resolve(response))\n            .catch(error => reject(error));\n        },\n        false\n      );\n      request.send();\n    });\n  }\n\n  postRequest(path, params) {\n    return new Promise((resolve, reject) => {\n      if (!this._settings || !this._settings.secret || !this._settings.address) {\n        return reject({\n          status: 400,\n          data: null,\n          message: 'Secret key and account address are required for a state-modifying call'\n        });\n      }\n\n      let request = new XMLHttpRequest();\n\n      request.open('POST', `${this._settings.apiEndpoint}/${path}`, true, this._settings);\n      request.setRequestHeader('Content-type', 'application/json; charset=utf-8');\n      request.setRequestHeader('Authorization', 'AMB ' + this._settings.secret);\n\n      request.onload = () => {\n        handleResponse(request)\n          .then(response => resolve(response))\n          .catch(error => reject(error));\n      };\n\n      request.send(JSON.stringify(params));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const checkTimeStamp = event => {\n  let timestamp = Math.floor(Date.now() / 1000);\n\n  return event.content && event.content.idData && event.content.idData.timestamp ? event.content.idData.timestamp : timestamp;\n};\n\nexport const parseEvents = eventsArray => {\n  return eventsArray.results.reduce(\n    (asset, { content, eventId }) => {\n      const timestamp = content.idData.timestamp;\n      const author = content.idData.createdBy;\n\n      if (content && content.data) {\n        content.data\n          .filter(obj => {\n            const [, eventCategory, eventType] = obj.type.split('.');\n\n            obj.timestamp = timestamp;\n            obj.author = author;\n            obj.name = obj.name || obj.type;\n            obj.action = '' + obj.type;\n            obj.type = eventType;\n            obj.eventId = eventId;\n\n            if (obj.type === 'location' && eventCategory === 'event') {\n              content.data.reduce((location, _event) => {\n                if (_event.type !== 'location') {\n                  _event.location = location;\n                }\n              }, obj);\n            } else {\n              return obj;\n            }\n          })\n          .map(event => {\n            if (['info', 'redirection', 'identifiers', 'branding'].indexOf(event.type) > -1) {\n              if (!asset[event.type] || asset[event.type].timestamp < event.timestamp) {\n                asset[event.type] = event;\n              }\n            } else {\n              asset.events.push(event);\n            }\n          });\n      }\n\n      return asset;\n    },\n    {\n      events: []\n    }\n  );\n};\n\nexport const serializeParams = params => {\n  let serializeParams = '';\n\n  for (let key in params) {\n    if (serializeParams !== '') {\n      serializeParams += '&';\n    }\n    serializeParams += key + '=' + encodeURIComponent(params[key]);\n  }\n  return serializeParams;\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Assets {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets/${encodeURIComponent(assetId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest('assets', params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Events {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events/${encodeURIComponent(eventId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest(`assets/${assetId}/events`, params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\n\nexport default class Auth {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      this._request\n        .postRequest('token', params)\n        .then(response => {\n          resolve(response);\n        })\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Assets from './api/assets';\nimport Events from './api/events';\nimport Auth from './api/auth';\nimport { checkTimeStamp, parseEvents } from './utils';\nimport { rejectResponse, successResponse } from './responseHandler';\n\nexport default class AmbrosusSDK {\n  constructor(extendSettings) {\n    this._settings = {\n      apiEndpoint: 'https://gateway-test.ambrosus.com'\n    };\n    this.events = {};\n    this.empty = [];\n\n    for (const key in extendSettings) {\n      if (extendSettings.hasOwnProperty(key)) {\n        this._settings[key] = extendSettings[key];\n      }\n    }\n\n    this._auth = new Auth(this._settings);\n    this._assets = new Assets(this._settings, this._auth);\n    this._events = new Events(this._settings, this._auth);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n      return this._assets.getAssetById(assetId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      if (!eventId) {\n        return reject(rejectResponse('Event ID is missing.'));\n      }\n\n      return this._events.getEventById(eventId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params = {}) {\n    return new Promise((resolve, reject) => {\n      return this._assets.getAssets(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      return this._events.getEvents(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(asset = {}) {\n    return new Promise((resolve, reject) => {\n\n      let params = {\n        content: {\n          idData: {\n            createdBy: this._settings.address,\n            timestamp: checkTimeStamp(asset),\n            sequenceNumber: 0\n          }\n        }\n      };\n\n      if (asset.data) {\n        params['data'] = asset.data;\n      }\n\n      return this._assets.createAsset(params)\n        .then(assetRes => {\n          if (asset.length >= 1) {\n            let finalEventResponse = [];\n\n            for (let i = 0; i < asset.length; i++) {\n              finalEventResponse[i] = new Promise((resolve, reject) => {\n                return this.createEvent(assetRes.data.assetId, asset[i]).then(eventRes => {\n                  resolve(eventRes);\n                });\n              });\n            }\n            this.emit('asset:created');\n            resolve(assetRes);\n          } else {\n            this.emit('asset:created');\n            resolve(assetRes);\n            return;\n          }\n        })\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, event) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n\n      if (!event) {\n        return reject(rejectResponse('Event data is missing.'));\n      }\n\n      let params = {\n        content: {\n          idData: {\n            assetId: assetId,\n            timestamp: checkTimeStamp(event),\n            accessLevel: 0,\n            createdBy: this._settings.address\n          }\n        }\n      };\n\n      if (event.content && event.content.data) {\n        params.content['data'] = event.content.data;\n      } else {\n        return reject(rejectResponse('Invalid data: No content found at content.data.'));\n      }\n\n      return this._events.createEvent(assetId, params)\n        .then((response) => { this.emit('event:created'); resolve(response); })\n        .catch(error => reject(error));\n    });\n  }\n\n  parseEvents(eventsArray) {\n    return new Promise((resolve, reject) => {\n\n      if (eventsArray && eventsArray.results) {\n        return resolve(successResponse(parseEvents(eventsArray)));\n      }\n\n      return reject(rejectResponse('Results array is missing.'));\n\n    });\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      if (!params && !params.validUntil) {\n        return reject(rejectResponse('Invalid data: Unix timestamp was not provided or has an invalid format'));\n      }\n      this._auth.getToken(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  on(type, func, ctx) {\n    (this.events[type] = this.events[type] || []).push([func, ctx]);\n    return this;\n  }\n\n  off(type, func) {\n    type || (this.events = {});\n    let list = this.events[type] || this.empty;\n    let i = (list.length = func ? list.length : 0);\n\n    while (i--) {\n      func === list[i][0] && list.splice(i, 1);\n    }\n    return this;\n  }\n\n  emit(type) {\n    let e = this.events[type] || this.empty;\n    let list = e.length > 0 ? e.slice(0, e.length) : e;\n    let i = 0;\n    let j;\n\n    while ((j = list[i++])) {\n      j[0].apply(j[1], this.empty.slice.call(arguments, 1));\n    }\n    return this;\n  }\n\n}\n"],"names":["handleResponse","request","Promise","resolve","reject","const","response","status","data","message","JSON","parse","reason","rejectResponse","successResponse","Request","settings","_settings","getRequest","path","let","XMLHttpRequest","open","this","apiEndpoint","addEventListener","then","catch","error","send","postRequest","params","secret","address","setRequestHeader","onload","stringify","checkTimeStamp","event","timestamp","Math","floor","Date","now","content","idData","parseEvents","eventsArray","results","reduce","asset","ref","author","createdBy","filter","obj","type","split","name","action","eventType","eventId","location","_event","map","indexOf","events","push","serializeParams","key","encodeURIComponent","Assets","_request","getAssetById","assetId","getAssets","createAsset","this$1","Events","getEventById","getEvents","createEvent","Auth","getToken","AmbrosusSDK","extendSettings","empty","hasOwnProperty","_auth","_assets","_events","sequenceNumber","assetRes","length","finalEventResponse","i","eventRes","emit","accessLevel","validUntil","on","func","ctx","off","list","splice","j","e","slice","apply","call","arguments"],"mappings":"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"}