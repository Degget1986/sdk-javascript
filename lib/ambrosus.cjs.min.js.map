{"version":3,"file":"ambrosus.cjs.min.js","sources":["../src/responseHandler.js","../src/api/request.js","../src/utils.js","../src/api/assets.js","../src/api/events.js","../src/api/auth.js","../src/index.js"],"sourcesContent":["/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const handleResponse = request => {\n  return new Promise((resolve, reject) => {\n    const response = {\n      status: request.status,\n      data: null,\n      message: JSON.parse(request.response).reason\n    };\n\n    if (request.status === 200 || request.status === 201) {\n      response.data = JSON.parse(request.response);\n      response.message = 'success';\n      resolve(response);\n    }\n    reject(response);\n  });\n};\n\nexport const rejectResponse = message => {\n  return {\n    status: 400,\n    data: null,\n    message: message\n  };\n};\n\nexport const successResponse = data => {\n  return {\n    status: 200,\n    data: data,\n    message: 'success'\n  };\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport { handleResponse } from './../responseHandler';\n\nexport default class Request {\n  constructor(settings) {\n    this._settings = settings;\n  }\n\n  getRequest(path) {\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open('GET', `${this._settings.apiEndpoint}/${path}`, true);\n      request.addEventListener(\n        'load',\n        () => {\n          handleResponse(request)\n            .then(response => resolve(response))\n            .catch(error => reject(error));\n        },\n        false\n      );\n      request.send();\n    });\n  }\n\n  postRequest(path, params) {\n    return new Promise((resolve, reject) => {\n      if (!this._settings || !this._settings.secret || !this._settings.address) {\n        return reject({\n          status: 400,\n          data: null,\n          message: 'Secret key and account address are required for a state-modifying call'\n        });\n      }\n\n      let request = new XMLHttpRequest();\n\n      request.open('POST', `${this._settings.apiEndpoint}/${path}`, true, this._settings);\n      request.setRequestHeader('Content-type', 'application/json; charset=utf-8');\n      request.setRequestHeader('Authorization', 'AMB ' + this._settings.secret);\n\n      request.onload = () => {\n        handleResponse(request)\n          .then(response => resolve(response))\n          .catch(error => reject(error));\n      };\n\n      request.send(JSON.stringify(params));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const checkTimeStamp = event => {\n  let timestamp = Math.floor(Date.now() / 1000);\n\n  return event.content && event.content.idData && event.content.idData.timestamp ? event.content.idData.timestamp : timestamp;\n};\n\nexport const parseEvents = eventsArray => {\n  return eventsArray.results.reduce(\n    (asset, { content, eventId }) => {\n      const timestamp = content.idData.timestamp;\n      const author = content.idData.createdBy;\n\n      if (content && content.data) {\n        content.data\n          .filter(obj => {\n            const parts = obj.type.split('.');\n            const type = parts[parts.length - 1];\n            const category = parts[parts.length - 2] || 'asset';\n            const namespace = parts[parts.length -3] || 'ambrosus';\n\n            obj.timestamp = timestamp;\n            obj.author = author;\n            obj.name = obj.name || type;\n            obj.action = type;\n            obj.type = type;\n            obj.eventId = eventId;\n\n            if (obj.type === 'location' && category === 'event') {\n              content.data.reduce((location, _event) => {\n                if (_event.type !== 'location') {\n                  _event.location = location;\n                }\n              }, obj);\n            } else {\n              return obj;\n            }\n          })\n          .map(event => {\n            if (['info', 'redirection', 'identifiers', 'branding'].indexOf(event.type) > -1) {\n              if (!asset[event.type] || asset[event.type].timestamp < event.timestamp) {\n                asset[event.type] = event;\n              }\n            } else {\n              asset.events.push(event);\n            }\n          });\n      }\n\n      return asset;\n    },\n    {\n      events: []\n    }\n  );\n};\n\nexport const serializeParams = params => {\n  let serializeParams = '';\n\n  for (let key in params) {\n    if (serializeParams !== '') {\n      serializeParams += '&';\n    }\n    serializeParams += key + '=' + encodeURIComponent(params[key]);\n  }\n  return serializeParams;\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Assets {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets/${encodeURIComponent(assetId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest('assets', params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Events {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events/${encodeURIComponent(eventId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest(`assets/${assetId}/events`, params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getBundleById(bundleId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`bundle/${encodeURIComponent(bundleId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\n\nexport default class Auth {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      this._request\n        .postRequest('token', params)\n        .then(response => {\n          resolve(response);\n        })\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Assets from './api/assets';\nimport Events from './api/events';\nimport Auth from './api/auth';\nimport { checkTimeStamp, parseEvents } from './utils';\nimport { rejectResponse, successResponse } from './responseHandler';\nlet assetSequenceNumber = 0;\n\nexport default class AmbrosusSDK {\n  constructor(extendSettings) {\n    this._settings = {\n      apiEndpoint: 'https://gateway-test.ambrosus.com'\n    };\n    this.events = {};\n    this.empty = [];\n\n    for (const key in extendSettings) {\n      if (extendSettings.hasOwnProperty(key)) {\n        this._settings[key] = extendSettings[key];\n      }\n    }\n\n    this._auth = new Auth(this._settings);\n    this._assets = new Assets(this._settings, this._auth);\n    this._events = new Events(this._settings, this._auth);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n      return this._assets.getAssetById(assetId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      if (!eventId) {\n        return reject(rejectResponse('Event ID is missing.'));\n      }\n\n      return this._events.getEventById(eventId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params = {}) {\n    return new Promise((resolve, reject) => {\n      return this._assets.getAssets(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      return this._events.getEvents(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(asset = {}) {\n    return new Promise((resolve, reject) => {\n\n      let params = {\n        content: {\n          idData: {\n            createdBy: this._settings.address,\n            timestamp: checkTimeStamp(asset),\n            sequenceNumber: assetSequenceNumber = (assetSequenceNumber + 1) % 1000000\n          }\n        }\n      };\n\n      return this._assets.createAsset(params)\n        .then(assetRes => {\n          if (asset.length >= 1) {\n            let finalEventResponse = [];\n\n            for (let i = 0; i < asset.length; i++) {\n              finalEventResponse[i] = new Promise((resolve, reject) => {\n                return this.createEvent(assetRes.data.assetId, asset[i]).then(eventRes => {\n                  resolve(eventRes);\n                });\n              });\n            }\n            this.emit('asset:created');\n            resolve(assetRes);\n          } else {\n            this.emit('asset:created');\n            resolve(assetRes);\n            return;\n          }\n        })\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, event) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n\n      if (!event) {\n        return reject(rejectResponse('Event data is missing.'));\n      }\n\n      let params = {\n        content: {\n          idData: {\n            assetId: assetId,\n            timestamp: checkTimeStamp(event),\n            accessLevel: 0,\n            createdBy: this._settings.address\n          }\n        }\n      };\n\n      if (event.content && event.content.data) {\n        params.content['data'] = event.content.data;\n      } else {\n        return reject(rejectResponse('Invalid data: No content found at content.data.'));\n      }\n\n      return this._events.createEvent(assetId, params)\n        .then((response) => { this.emit('event:created'); resolve(response); })\n        .catch(error => reject(error));\n    });\n  }\n\n  parseEvents(eventsArray) {\n    return new Promise((resolve, reject) => {\n\n      if (eventsArray && eventsArray.results) {\n        return resolve(successResponse(parseEvents(eventsArray)));\n      }\n\n      return reject(rejectResponse('Results array is missing.'));\n\n    });\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      if (!params && !params.validUntil) {\n        return reject(rejectResponse('Invalid data: Unix timestamp was not provided or has an invalid format'));\n      }\n      this._auth.getToken(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getBundleById(bundleId) {\n    return new Promise((resolve, reject) => {\n      if (!bundleId) {\n        return reject(rejectResponse('Bundle ID is missing.'));\n      }\n      return this._events.getBundleById(bundleId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  on(type, func, ctx) {\n    (this.events[type] = this.events[type] || []).push([func, ctx]);\n    return this;\n  }\n\n  off(type, func) {\n    type || (this.events = {});\n    let list = this.events[type] || this.empty;\n    let i = (list.length = func ? list.length : 0);\n\n    while (i--) {\n      func === list[i][0] && list.splice(i, 1);\n    }\n    return this;\n  }\n\n  emit(type) {\n    let e = this.events[type] || this.empty;\n    let list = e.length > 0 ? e.slice(0, e.length) : e;\n    let i = 0;\n    let j;\n\n    while ((j = list[i++])) {\n      j[0].apply(j[1], this.empty.slice.call(arguments, 1));\n    }\n    return this;\n  }\n\n}\n"],"names":["handleResponse","request","Promise","resolve","reject","const","response","status","data","message","JSON","parse","reason","rejectResponse","successResponse","Request","settings","_settings","getRequest","path","let","XMLHttpRequest","open","this","apiEndpoint","addEventListener","then","catch","error","send","postRequest","params","secret","address","setRequestHeader","onload","stringify","checkTimeStamp","event","timestamp","Math","floor","Date","now","content","idData","parseEvents","eventsArray","results","reduce","asset","ref","author","createdBy","filter","obj","parts","type","split","length","category","namespace","name","action","eventId","location","_event","map","indexOf","events","push","serializeParams","key","encodeURIComponent","Assets","_request","getAssetById","assetId","getAssets","createAsset","this$1","Events","getEventById","getEvents","createEvent","getBundleById","bundleId","Auth","getToken","assetSequenceNumber","AmbrosusSDK","extendSettings","empty","hasOwnProperty","_auth","_assets","_events","sequenceNumber","assetRes","finalEventResponse","i","eventRes","emit","accessLevel","validUntil","on","func","ctx","off","list","splice","j","e","slice","apply","call","arguments"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;oDAQaA,yBAAiBC,EAAQ,CACpC,MAAO,IAAIC,QAAJ,UAAaC,EAASC,EAAQ,CACnCC,GAAMC,GAAW,CACfC,OAAQN,EAAQM,MADD,CAEfC,KAAM,IAFS,CAGfC,QAASC,KAAKC,KAAL,CAAWV,EAAQK,QAAnB,EAA6BM,MAHvB,CAAjBP,CADmC,CAOZ,GAAnB,KAAQE,MAAR,EAA6C,GAAnB,KAAQA,MAPH,IAQjCD,EAASE,IAAT,CAAgBE,KAAKC,KAAL,CAAWV,EAAQK,QAAnB,CARiB,CASjCA,EAASG,OAAT,CAAmB,SATc,CAUjCN,EAAQG,CAAR,CAViC,EAYnCF,EAAOE,CAAP,CACD,CAbM,CAcR,EAEYO,wBAAiBJ,EAAQ,CACpC,MAAO,CACLF,OAAQ,GADH,CAELC,KAAM,IAFD,CAGLC,QAASA,CAHJ,CAKR,EAEYK,yBAAkBN,EAAK,CAClC,MAAO,CACLD,OAAQ,GADH,CAELC,KAAMA,CAFD,CAGLC,QAAS,SAHJ,CAKR,EC7BoBM,QACnB,SAAYC,CAAZ,CAAsB,CACpB,KAAKC,SAAL,CAAiBD,GAGrBD,iBAAA,CAAEG,UAAF,UAAaC,EAAM,YACjB,MAAS,IAAIjB,QAAJ,UAAaC,EAASC,EAAQ,CACnCgB,GAAInB,GAAU,GAAIoB,eAAlBD,CAEAnB,EAAQqB,IAAR,CAAa,KAAb,CAAuBC,EAAKN,SAALM,CAAeC,gBAAeL,CAArD,IAHmC,CAIrClB,EAAUwB,gBAAV,CACI,MADJ,CAEE,UAAK,CACHzB,eAAiBC,CAAjB,EACKyB,IADL,UACUpB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADvC,EAEKqB,KAFL,UAEWC,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFjC,CAGC,CANL,IAJqC,CAanC3B,EAAQ4B,IAAR,EACD,CAdM,GAiBXd,iBAAA,CAAEe,WAAF,UAAcX,EAAMY,EAAQ,YAC1B,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACnC,GAAI,CAACmB,EAAKN,SAAN,EAAmB,CAACM,EAAKN,SAALM,CAAeS,MAAnC,EAA6C,CAACT,EAAKN,SAALM,CAAeU,OAAjE,CACA,MAAS7B,GAAO,CACdG,OAAU,GADI,CAEdC,KAAQ,IAFM,CAGdC,QAAW,wEAHG,CAAP,CAAT,CAOAW,GAAInB,GAAU,GAAIoB,eAAlBD,CAEFnB,EAAUqB,IAAV,CAAe,MAAf,CAA0BC,EAAKN,SAALM,CAAeC,gBAAeL,CAAxD,IAAsEI,EAAKN,SAA3E,CAXqC,CAYrChB,EAAUiC,gBAAV,CAA2B,cAA3B,CAA2C,iCAA3C,CAZqC,CAanCjC,EAAQiC,gBAAR,CAAyB,eAAzB,CAA0C,OAASX,EAAKN,SAALM,CAAeS,MAAlE,CAbmC,CAenC/B,EAAQkC,MAAR,WAAoB,CACpBnC,eAAiBC,CAAjB,EACKyB,IADL,UACUpB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADvC,EAEKqB,KAFL,UAEWC,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFjC,CAGC,CAnBkC,CAqBrC3B,EAAU4B,IAAV,CAAenB,KAAK0B,SAAL,CAAeL,CAAf,CAAf,CACC,CAtBM,CAuBR,KCjDUM,yBAAiBC,EAAM,CAClClB,GAAImB,GAAYC,KAAKC,KAAL,CAAWC,KAAKC,GAAL,GAAa,GAAxB,CAAhBvB,CAEA,MAAOkB,GAAMM,OAAN,EAAiBN,EAAMM,OAAN,CAAcC,MAA/B,EAAyCP,EAAMM,OAAN,CAAcC,MAAd,CAAqBN,SAA9D,CAA0ED,EAAMM,OAAN,CAAcC,MAAd,CAAqBN,SAA/F,CAA2GA,CACnH,EAEYO,qBAAcC,EAAY,CACrC,MAAOA,GAAYC,OAAZ,CAAoBC,MAApB,UACJC,EAAOC,EAAsB,gBAAA,YAAA,CACtBZ,EAAYK,EAAQC,MAAR,CAAeN,SADL,CAEtBa,EAASR,EAAQC,MAAR,CAAeQ,SAFF,CAwC5B,MApCIT,IAAWA,EAAQpC,IAoCvB,EAnCEoC,EAAQpC,IAAR,CACG8C,MADH,UACUC,EAAI,IACJC,GAAQD,EAAIE,IAAJ,CAASC,KAAT,CAAe,GAAf,CADJ,CAEJD,EAAOD,EAAMA,EAAMG,MAAN,CAAe,CAArB,CAFH,CAGJC,EAAWJ,EAAMA,EAAMG,MAAN,CAAe,CAArB,GAA2B,OAHlC,CAIJE,EAAYL,EAAMA,EAAMG,MAAN,CAAc,CAApB,GAA0B,UAJlC,OAMVJ,GAAIhB,SAAJ,CAAgBA,CANN,CAOVgB,EAAIH,MAAJ,CAAaA,CAPH,CAQVG,EAAIO,IAAJ,CAAWP,EAAIO,IAAJ,EAAYL,CARb,CASVF,EAAIQ,MAAJ,CAAaN,CATH,CAUVF,EAAIE,IAAJ,CAAWA,CAVD,CAWVF,EAAIS,OAAJ,CAAcA,CAXJ,CAaO,UAAb,KAAIP,IAAJ,EAAwC,OAAb,IAbrB,KAcRb,GAAQpC,IAAR,CAAayC,MAAb,UAAqBgB,EAAUC,EAAQ,CACjB,UAAhB,KAAOT,IAD0B,GAEnCS,EAAOD,QAAP,CAAkBA,CAFiB,CAItC,CAJD,CAIGV,CAJH,CAdQ,CAoBDA,CAEV,CAvBH,EAwBGY,GAxBH,UAwBO7B,EAAM,CACoE,CAAC,CAA1E,EAAC,MAAD,CAAS,aAAT,CAAwB,aAAxB,CAAuC,UAAvC,EAAmD8B,OAAnD,CAA2D9B,EAAMmB,IAAjE,CADK,EAEH,CAACP,EAAMZ,EAAMmB,IAAZ,CAAD,EAAsBP,EAAMZ,EAAMmB,IAAZ,EAAkBlB,SAAlB,CAA8BD,EAAMC,SAFvD,IAGLW,EAAMZ,EAAMmB,IAAZ,EAAoBnB,CAHf,EAMPY,EAAMmB,MAAN,CAAaC,IAAb,CAAkBhC,CAAlB,CAEH,CAhCH,CAmCF,CAAOY,CACR,CA1CI,CA2CL,CACEmB,OAAQ,EADV,CA3CK,CA+CR,EAEYE,yBAAkBxC,EAAO,CACpCX,GAAImD,GAAkB,EAAtBnD,CAEA,IAAKA,GAAIoD,EAAT,GAAgBzC,EAAhB,CAC0B,EAApB,GADN,GAEIwC,GAAmB,GAFvB,EAIEA,GAAmBC,EAAM,GAAN,CAAYC,mBAAmB1C,EAAOyC,CAAP,CAAnB,CAJjC,CAMA,MAAOD,EACR,EC/DoBG,OACnB,SAAY1D,CAAZ,CAA4B,CAC1B,KAAKC,SAAL,CAAiBD,CADS,CAE5B,KAAO2D,QAAP,CAAkB,GAAI5D,QAAJ,CAAY,KAAKE,SAAjB,GAGpByD,gBAAA,CAAEE,YAAF,UAAeC,EAAS,YACtB,MAAS,IAAI3E,QAAJ,UAAaC,EAASC,EAAQ,CACnCmB,EAAKoD,QAALpD,CAAcL,UAAdK,WAAmCkD,mBAAmBI,CAAnB,CAAnCtD,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAGD,CAJM,GAOXmD,gBAAA,CAAEI,SAAF,UAAY/C,EAAQ,YAClB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACnCmB,EAAKoD,QAALpD,CAAcL,UAAdK,WAAmCgD,gBAAgBxC,CAAhB,CAAnCR,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAGD,CAJM,GAOXmD,gBAAA,CAAEK,WAAF,UAAchD,EAAQ,YACpB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACrC4E,EAAOL,QAAP,CAAgB7C,WAAhB,CAA4B,QAA5B,CAAsCC,CAAtC,EACKL,IADL,UACUpB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADvC,EAEKqB,KAFL,UAEWC,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFjC,CAGC,CAJM,CAKR,EC5BH,GAAqBqD,QACnB,SAAYjE,CAAZ,CAA4B,CAC1B,KAAKC,SAAL,CAAiBD,CADS,CAE5B,KAAO2D,QAAP,CAAkB,GAAI5D,QAAJ,CAAY,KAAKE,SAAjB,EAHpB,CAMAgE,gBAAA,CAAEC,YAAF,UAAelB,EAAS,YACtB,MAAS,IAAI9D,QAAJ,UAAaC,EAASC,EAAQ,CACnCmB,EAAKoD,QAALpD,CAAcL,UAAdK,WAAmCkD,mBAAmBT,CAAnB,CAAnCzC,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAGD,CAJM,GAOX0D,gBAAA,CAAEE,SAAF,UAAYpD,EAAQ,YAClB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACnCmB,EAAKoD,QAALpD,CAAcL,UAAdK,WAAmCgD,gBAAgBxC,CAAhB,CAAnCR,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAGD,CAJM,GAOX0D,gBAAA,CAAEG,WAAF,UAAcP,EAAS9C,EAAQ,YAC7B,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACrC4E,EAAOL,QAAP,CAAgB7C,WAAhB,WAAsC+C,WAAtC,CAAwD9C,CAAxD,EACKL,IADL,UACUpB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADvC,EAEKqB,KAFL,UAEWC,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFjC,CAGC,CAJM,GAOXqD,gBAAA,CAAEI,aAAF,UAAgBC,EAAU,YACxB,MAAS,IAAIpF,QAAJ,UAAaC,EAASC,EAAQ,CACnCmB,EAAKoD,QAALpD,CAAcL,UAAdK,WAAmCkD,mBAAmBa,CAAnB,CAAnC/D,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAGD,CAJM,CAKR,ECrCY,GAAMgE,MACnB,SAAYvE,CAAZ,CAAsB,CACpB,KAAKC,SAAL,CAAiBD,CADG,CAEtB,KAAO2D,QAAP,CAAkB,GAAI5D,QAAJ,CAAY,KAAKE,SAAjB,EAHL,CAMfsE,cAAA,CAAEC,QAAF,UAAWzD,EAAQ,YACjB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACrC4E,EAAOL,QAAP,CACK7C,WADL,CACiB,OADjB,CAC0BC,CAD1B,EAEKL,IAFL,UAEUpB,EAAS,CACbH,EAAQG,CAAR,CACD,CAJL,EAKKqB,KALL,UAKWC,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CALjC,CAMC,CAPM,CAQR,KCZC6D,qBAAsB,EAELC,YACnB,SAAYC,CAAZ,CAA4B,YAO1B,IAAKtF,GAAMmE,EAAX,GANF,MAAOvD,SAAP,CAAmB,CACjBO,YAAe,mCADE,CAMjB,CAHA,KAAK6C,MAAL,CAAc,EAGd,CAFA,KAAKuB,KAAL,CAAa,EAEb,CAAkBD,CAAlB,CACMA,EAAeE,cAAf,CAA8BrB,CAA9B,CADN,GAEEQ,EAAO/D,SAAP,CAAiBuD,CAAjB,EAAwBmB,EAAenB,CAAf,CAF1B,EAMF,KAAOsB,KAAP,CAAe,GAAIP,KAAJ,CAAS,KAAKtE,SAAd,CAba,CAc1B,KAAK8E,OAAL,CAAe,GAAIrB,OAAJ,CAAW,KAAKzD,SAAhB,CAA2B,KAAK6E,KAAhC,CAdW,CAe1B,KAAKE,OAAL,CAAe,GAAIf,OAAJ,CAAW,KAAKhE,SAAhB,CAA2B,KAAK6E,KAAhC,GAGnBJ,qBAAA,CAAEd,YAAF,UAAeC,EAAS,YACtB,MAAS,IAAI3E,QAAJ,UAAaC,EAASC,EAAQ,OAC9ByE,EAD8B,CAI5BtD,EAAKwE,OAALxE,CAAaqD,YAAbrD,CAA0BsD,CAA1BtD,EACJG,IADIH,UACCjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CAD9BiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAJ4B,CAE1BnB,EAAOS,eAAe,sBAAf,CAAP,CAKV,CAPM,GAUX6E,qBAAA,CAAER,YAAF,UAAelB,EAAS,YACtB,MAAS,IAAI9D,QAAJ,UAAaC,EAASC,EAAQ,OAC9B4D,EAD8B,CAK5BzC,EAAKyE,OAALzE,CAAa2D,YAAb3D,CAA0ByC,CAA1BzC,EACJG,IADIH,UACCjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CAD9BiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAL4B,CAE1BnB,EAAOS,eAAe,sBAAf,CAAP,CAMV,CARM,GAWX6E,qBAAA,CAAEZ,SAAF,UAAY/C,EAAa,YACvB,iBAAA,KADmB,EACnB,EAAS,GAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACrC,MAASmB,GAAKwE,OAALxE,CAAauD,SAAbvD,CAAuBQ,CAAvBR,EACJG,IADIH,UACCjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CAD9BiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAGR,CAJM,GAOXmE,qBAAA,CAAEP,SAAF,UAAYpD,EAAQ,YAClB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,CACrC,MAASmB,GAAKyE,OAALzE,CAAa4D,SAAb5D,CAAuBQ,CAAvBR,EACJG,IADIH,UACCjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CAD9BiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAGR,CAJM,GAOXmE,qBAAA,CAAEX,WAAF,UAAc7B,EAAY,YACxB,iBAAA,KADoB,EACpB,EAAS,GAAIhD,QAAJ,UAAaC,EAASC,EAAQ,CAErC,GAAM2B,GAAS,CACXa,QAAS,CACPC,OAAQ,CACNQ,UAAW9B,EAAKN,SAALM,CAAeU,OADpB,CAENM,UAAWF,eAAea,CAAf,CAFL,CAGR+C,eAAkBR,oBAAsB,CAACA,oBAAsB,CAAvB,EAA4B,GAH5D,CADD,CADE,CAAf,CAUA,MAASlE,GAAKwE,OAALxE,CAAawD,WAAbxD,CAAyBQ,CAAzBR,EACJG,IADIH,UACC2E,EAAS,CACb,GAAoB,CAAhB,IAAMvC,MAAV,CAAuB,CAGrB,OAFIwC,GAAqB,EAEzB,cAAuC,CACrCA,EAAmBC,CAAnB,EAAwB,GAAIlG,QAAJ,UAAaC,EAAiB,CACtD,MAASoB,GAAK6D,WAAL7D,CAAiB2E,EAAS1F,IAAT,CAAcqE,OAA/BtD,CAAwC2B,EAAMkD,CAAN,CAAxC7E,EAAkDG,IAAlDH,UAAuD8E,EAAS,CACrElG,EAAQkG,CAAR,CACD,CAFM9E,CAGR,CAJuB,EAD1B,CAAS6E,EAAI,CAAb,CAAgBA,EAAIlD,EAAMS,MAA1B,CAAkCyC,GAAlC,MAOA7E,EAAK+E,IAAL/E,CAAU,eAAVA,CAVqB,CAWrBpB,EAAQ+F,CAAR,CACD,CAZD,IAeE,OAFA3E,GAAK+E,IAAL/E,CAAU,eAAVA,CAEA,KADApB,GAAQ+F,CAAR,CAGH,CAnBI3E,EAoBJI,KApBIJ,UAoBEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CApBxBL,CAqBR,CAjCM,GAoCXmE,qBAAA,CAAEN,WAAF,UAAcP,EAASvC,EAAO,YAC5B,MAAS,IAAIpC,QAAJ,UAAaC,EAASC,EAAQ,CACrC,GAAM,CAACyE,CAAP,CACE,MAASzE,GAAOS,eAAe,sBAAf,CAAP,CAAT,CAGF,GAAM,CAACyB,CAAP,CACE,MAASlC,GAAOS,eAAe,wBAAf,CAAP,CAAT,CAGF,GAAMkB,GAAS,CACXa,QAAS,CACPC,OAAQ,CACRgC,QAAWA,CADH,CAENtC,UAAWF,eAAeC,CAAf,CAFL,CAGRiE,YAAe,CAHP,CAINlD,UAAW9B,EAAKN,SAALM,CAAeU,OAJpB,CADD,CADE,CAAf,CAWA,GAAMK,EAAMM,OAAN,EAAiBN,EAAMM,OAAN,CAAcpC,IAArC,CACIuB,EAAOa,OAAP,MAAyBN,EAAMM,OAAN,CAAcpC,IAD3C,KAGE,OAASJ,GAAOS,eAAe,iDAAf,CAAP,CAAT,CAGF,MAASU,GAAKyE,OAALzE,CAAa6D,WAAb7D,CAAyBsD,CAAzBtD,CAAkCQ,CAAlCR,EACJG,IADIH,UACEjB,EAAa,CAAEiB,EAAK+E,IAAL/E,CAAU,eAAVA,CAAF,CAA8BpB,EAAQG,CAAR,CAAoB,CADjEiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAGR,CA7BM,GAgCXmE,qBAAA,CAAE5C,WAAF,UAAcC,EAAa,CACzB,MAAS,IAAI7C,QAAJ,UAAaC,EAASC,EAAQ,OAE/B2C,IAAeA,EAAYC,OAFI,CAG1B7C,EAAQW,gBAAgBgC,YAAYC,CAAZ,CAAhB,CAAR,CAH0B,CAM5B3C,EAAOS,eAAe,2BAAf,CAAP,CAER,CARM,GAWX6E,qBAAA,CAAEF,QAAF,UAAWzD,EAAQ,YACjB,MAAS,IAAI7B,QAAJ,UAAaC,EAASC,EAAQ,OAC9B2B,EAAD,EAAYA,EAAOyE,UADY,KAInCjF,GAAKuE,KAALvE,CAAWiE,QAAXjE,CAAoBQ,CAApBR,EACGG,IADHH,UACQjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CADrCiB,EAEGI,KAFHJ,UAESK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAF/BL,CAJmC,CAE1BnB,EAAOS,eAAe,wEAAf,CAAP,CAKV,CAPM,GAUX6E,qBAAA,CAAEL,aAAF,UAAgBC,EAAU,YACxB,MAAS,IAAIpF,QAAJ,UAAaC,EAASC,EAAQ,OAC9BkF,EAD8B,CAI5B/D,EAAKyE,OAALzE,CAAa8D,aAAb9D,CAA2B+D,CAA3B/D,EACJG,IADIH,UACCjB,EAAS,OAAGH,GAAQG,CAAR,CAAiB,CAD9BiB,EAEJI,KAFIJ,UAEEK,EAAM,OAAGxB,GAAOwB,CAAP,CAAa,CAFxBL,CAJ4B,CAE1BnB,EAAOS,eAAe,uBAAf,CAAP,CAKV,CAPM,GAUX6E,qBAAA,CAAEe,EAAF,UAAKhD,EAAMiD,EAAMC,EAAK,CAEpB,MADA,CAAG,KAAKtC,MAAL,CAAYZ,CAAZ,EAAoB,KAAKY,MAAL,CAAYZ,CAAZ,GAAqB,EAA5C,EAAgDa,IAAhD,CAAqD,CAACoC,CAAD,CAAOC,CAAP,CAArD,CACA,CAAS,MAGXjB,qBAAA,CAAEkB,GAAF,UAAMnD,EAAMiD,EAAM,CAChBjD,IAAW,KAAKY,MAAL,CAAc,EAAzB,CADgB,QAEVwC,GAAO,KAAKxC,MAAL,CAAYZ,CAAZ,GAAqB,KAAKmC,KAFvB,CAGVQ,EAAKS,EAAKlD,MAAL,CAAc+C,EAAOG,EAAKlD,MAAZ,CAAqB,CAH9B,CAKPyC,GALO,EAMZM,IAASG,EAAKT,CAAL,EAAQ,CAAR,CAAT,EAAuBS,EAAKC,MAAL,CAAYV,CAAZ,CAAe,CAAf,CAAvB,CAEJ,MAAS,OAGXV,qBAAA,CAAEY,IAAF,UAAO7C,EAAM,QAILsD,EAJK,YAAA,OAAA,CACLC,EAAI,KAAK3C,MAAL,CAAYZ,CAAZ,GAAqB,KAAKmC,KADzB,CAELiB,EAAkB,CAAX,GAAElD,MAAF,CAAeqD,EAAEC,KAAF,CAAQ,CAAR,CAAWD,EAAErD,MAAb,CAAf,CAAsCqD,CAFxC,CAGLZ,EAAI,CAHC,CAMDW,EAAIF,EAAKT,GAAL,CANH,EAOTW,EAAI,CAAJ,EAAOG,KAAP,CAAaH,EAAE,CAAF,CAAb,CAAmBxF,EAAKqE,KAALrE,CAAW0F,KAAX1F,CAAiB4F,IAAjB5F,CAAsB6F,CAAtB7F,CAAiC,CAAjCA,CAAnB,EAEF,MAAS,KACR"}