{"version":3,"file":"ambrosus.cjs.min.js","sources":["../src/responseHandler.js","../src/api/request.js","../src/utils.js","../src/api/assets.js","../src/api/events.js","../src/api/accounts.js","../src/index.js"],"sourcesContent":["/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const handleResponse = request => {\n  return new Promise((resolve, reject) => {\n    const response = {\n      status: request.status,\n      data: null,\n      message: JSON.parse(request.response).reason\n    };\n\n    if (request.status === 200 || request.status === 201) {\n      response.data = JSON.parse(request.response);\n      response.message = 'success';\n      resolve(response);\n    }\n    reject(response);\n  });\n};\n\nexport const rejectResponse = message => {\n  return {\n    status: 400,\n    data: null,\n    message: message\n  };\n};\n\nexport const successResponse = data => {\n  return {\n    status: 200,\n    data: data,\n    message: 'success'\n  };\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport { handleResponse } from './../responseHandler';\n\nexport default class Request {\n  constructor(settings) {\n    this._settings = settings;\n  }\n\n  getRequest(path) {\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open('GET', `${this._settings.apiEndpoint}/${path}`, true);\n      if (this._settings.headers) {\n        for (const key in this._settings.headers) {\n          request.setRequestHeader(`${key}`, `${this._settings.headers[key]}`);\n        }\n      }\n      request.addEventListener(\n        'load',\n        () => {\n          handleResponse(request)\n            .then(response => resolve(response))\n            .catch(error => reject(error));\n        },\n        false\n      );\n      request.send();\n    });\n  }\n\n  postRequest(path, params, hasHeader = false) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open('POST', `${this._settings.apiEndpoint}/${path}`, true, this._settings);\n      request.setRequestHeader('Content-type', 'application/json; charset=utf-8');\n      \n      if (this._settings.headers && hasHeader === true) {\n        for (const key in this._settings.headers) {\n          request.setRequestHeader(`${key}`, `${this._settings.headers[key]}`);\n        }\n      }\n\n      request.onload = () => {\n        handleResponse(request)\n          .then(response => resolve(response))\n          .catch(error => reject(error));\n      };\n\n      request.send(JSON.stringify(params));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\nexport const timeSince = date => {\n  try {\n    let seconds = Math.floor((+new Date() - date) / 1000);\n    let interval = Math.floor(seconds / 31536000);\n\n    if (interval >= 1) {\n      return interval + \" year\" + (interval > 1 ? 's' : '');\n    }\n    interval = Math.floor(seconds / 2592000);\n    if (interval >= 1) {\n      return interval + \" month\" + (interval > 1 ? 's' : '');\n    }\n    interval = Math.floor(seconds / 86400);\n    if (interval >= 1) {\n      return interval + \" day\" + (interval > 1 ? 's' : '');\n    }\n    interval = Math.floor(seconds / 3600);\n    if (interval >= 1) {\n      return interval + \" hour\" + (interval > 1 ? 's' : '');\n    }\n    interval = Math.floor(seconds / 60);\n    if (interval >= 1) {\n      return interval + \" minute\" + (interval > 1 ? 's' : '');\n    }\n\n    seconds = seconds < 1 ? 1 : seconds;\n\n    return Math.floor(seconds) + \" second\" + (seconds !== 1 ? 's' : '');\n  } catch (error) {\n    return '';\n  }\n}\n\nexport const validTimestamp = timestamp => {\n  return new Date(timestamp).getTime() > 0;\n};\n\nexport const checkTimeStamp = event => {\n  let timestamp = Math.floor(Date.now() / 1000);\n\n  return event.content && event.content.idData && event.content.idData.timestamp && validTimestamp(event.content.idData.timestamp) ? event.content.idData.timestamp : timestamp;\n};\n\nexport const parseEvents = eventsArray => {\n  return eventsArray.results.reduce(\n    (asset, {\n      content,\n      eventId\n    }) => {\n      const timestamp = content.idData.timestamp;\n      const author = content.idData.createdBy;\n\n      if (content && content.data) {\n        content.data\n          .filter(obj => {\n            const parts = obj.type.split('.');\n            const type = parts[parts.length - 1];\n            const category = parts[parts.length - 2] || 'asset';\n            const namespace = parts[parts.length - 3] || 'ambrosus';\n\n            obj.timestamp = timestamp;\n            obj.author = author;\n            obj.name = obj.name || type;\n            obj.action = type;\n            obj.type = type;\n            obj.eventId = eventId;\n\n            if ((obj.type === 'location' || obj.type === 'identifiers') && category === 'event') {\n              content.data.reduce((_obj, _event) => {\n                if (obj.type === 'location' && _event.type !== 'location') {\n                  _event.location = _obj;\n                }\n                if (obj.type === 'identifiers' && _event.type !== 'identifiers') {\n                  _event.identifiers = _obj;\n                }\n                return _obj;\n              }, obj);\n            } else {\n              return obj;\n            }\n          })\n          .map(event => {\n            if (['info', 'redirection', 'identifiers', 'branding'].indexOf(event.type) > -1) {\n              if (!asset[event.type] || asset[event.type].timestamp < event.timestamp) {\n                asset[event.type] = event;\n              }\n            } else {\n              asset.events.push(event);\n            }\n          });\n      }\n\n      return asset;\n    }, {\n      events: []\n    }\n  );\n};\n\nexport const serializeParams = params => {\n  let serializeParams = '';\n\n  for (let key in params) {\n    if (serializeParams !== '') {\n      serializeParams += '&';\n    }\n    serializeParams += key + '=' + encodeURIComponent(params[key]);\n  }\n  return serializeParams;\n};\n\nexport const serializeForHashing = (object) => {\n  const isDict = (subject) => typeof subject === 'object' && !Array.isArray(subject);\n  const isString = (subject) => typeof subject === 'string';\n  const isArray = (subject) => Array.isArray(subject);\n\n  if (isDict(object)) {\n    const content = Object.keys(object).sort().map((key) => `\"${key}\":${serializeForHashing(object[key])}`).join(',');\n\n    return `{${content}}`;\n  } else if (isArray(object)) {\n    const content = object.map((item) => serializeForHashing(item)).join(',');\n\n    return `[${content}]`;\n  } else if (isString(object)) {\n    return `\"${object}\"`;\n  }\n  return object.toString();\n};\n\n// private method for UTF-8 encoding\nexport const utf8Encode = (string) => {\n  string = string.replace(/\\r\\n/g, '\\n');\n  let utftext = '';\n\n  for (let n = 0; n < string.length; n++) {\n\n    let c = string.charCodeAt(n);\n\n    if (c < 128) {\n      utftext += String.fromCharCode(c);\n    } else if ((c > 127) && (c < 2048)) {\n      utftext += String.fromCharCode((c >> 6) | 192);\n      utftext += String.fromCharCode((c & 63) | 128);\n    } else {\n      utftext += String.fromCharCode((c >> 12) | 224);\n      utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n      utftext += String.fromCharCode((c & 63) | 128);\n    }\n\n  }\n\n  return utftext;\n};\n\nlet _keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nexport const base64url = (input) => {\n  let output = '';\n  let chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n  let i = 0;\n\n  input = utf8Encode(input);\n\n  while (i < input.length) {\n\n    chr1 = input.charCodeAt(i++);\n    chr2 = input.charCodeAt(i++);\n    chr3 = input.charCodeAt(i++);\n\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n    enc4 = chr3 & 63;\n\n    if (isNaN(chr2)) {\n      enc3 = enc4 = 64;\n    } else if (isNaN(chr3)) {\n      enc4 = 64;\n    }\n\n    output = output +\n      _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n      _keyStr.charAt(enc3) + _keyStr.charAt(enc4);\n  }\n\n  return output;\n\n};\n\nexport const checkAccessLevel = event => {\n  try {\n    return event.content.idData.accessLevel;\n  } catch (error) {\n    return 0;\n  }\n};\n\nexport const getName = (obj, alternative = 'No title') => {\n  try {\n    const name = obj.name;\n    let type = obj.type.split('.');\n    type = type[type.length - 1];\n    return [name, type].find(i => i);\n  } catch (e) {\n    return alternative;\n  }\n};\n\nexport const getUrlName = (url) => {\n  let name = url.split('/');\n  name = name[name.length - 1];\n  return name;\n};\n\nexport const getImage = (obj) => {\n  try {\n    return obj.images.default.url;\n  } catch (e) {\n    return '';\n  }\n};\n\nexport const getLocation = (event) => {\n  const location = event.location || event;\n  const {\n    city,\n    country,\n    name\n  } = location;\n  return (\n    [city, country, name].filter(item => !!item).join(', ') || 'No place attached'\n  );\n};\n\nexport const sortEventsByTimestamp = (a, b) => {\n  if (a.timestamp > b.timestamp) {\n    return -1;\n  }\n  if (a.timestamp < b.timestamp) {\n    return 1;\n  }\n  return 0;\n};\n\nexport const parseEvent = (event) => {\n  event.info = {};\n  event.info['groups'] = [];\n  event.info['properties'] = [];\n\n  // Extract event objects\n  if (event.content.data && Array.isArray(event.content.data)) {\n    event.content.data.map((obj, index, array) => {\n      const type = obj.type.split('.');\n      obj.type = type[type.length - 1].toLowerCase();\n\n      if (obj.type === 'location' || obj.type === 'identifiers') {\n        event.info[obj.type] = obj;\n      } else {\n        event.info.name = obj.name || obj.type;\n\n        Object.keys(obj).map((key) => {\n          if (['images', 'documents', 'description'].indexOf(key) > -1) {\n            event.info[key] = obj[key];\n          }\n\n          if (\n            [\n              'type',\n              'name',\n              'assetType',\n              'eventId',\n              'createdBy',\n              'timestamp',\n              'location',\n              'images',\n              'documents',\n              'description',\n              'identifiers',\n              'groups',\n              'properties',\n            ].indexOf(key) === -1\n          ) {\n            const property = {\n              key,\n              value: obj[key],\n            };\n            event.info[\n              typeof property.value === 'string' ||\n              Array.isArray(property.value) ?\n              'properties' :\n              'groups'\n            ].push(property);\n          }\n        });\n      }\n\n      return obj;\n    });\n  }\n\n  return event;\n};\n\nexport const parseAsset = (asset) => {\n  if (!asset.info) {\n    asset.info = {};\n  }\n  asset.info['groups'] = [];\n  asset.info['properties'] = [];\n\n  Object.keys(asset.info).map((key) => {\n    if (key === 'location' || key === 'identifiers') {\n      asset[key] = asset.info[key];\n    } else {\n      if (\n        [\n          'type',\n          'name',\n          'assetType',\n          'images',\n          'eventId',\n          'createdBy',\n          'timestamp',\n          'groups',\n          'properties',\n        ].indexOf(key) === -1\n      ) {\n        const property = {\n          key,\n          value: asset.info[key],\n        };\n        asset.info[\n          typeof property.value === 'string' || Array.isArray(property.value) ?\n          'properties' :\n          'groups'\n        ].push(property);\n      }\n    }\n  });\n};\n\nexport const parseTimelineEvents = (e) => {\n  const events = e.reduce((_events, {\n    content,\n    eventId\n  }) => {\n    const timestamp = content.idData.timestamp;\n    const createdBy = content.idData.createdBy;\n\n    if (content && content.data) {\n      content.data.map(obj => {\n        const parts = obj.type.split('.');\n        const type = parts[parts.length - 1];\n        const category = parts[parts.length - 2] || 'asset';\n        const namespace = parts[parts.length - 3] || 'ambrosus';\n        const ago = timeSince(timestamp * 1000);\n\n        obj.timestamp = timestamp;\n        obj.createdBy = createdBy;\n        obj.name = obj.name || type;\n        obj.type = type;\n        obj.eventId = eventId;\n        obj.ago = ago;\n\n        if (obj.type === 'location' && category === 'event') {\n          content.data.reduce((location, _event) => {\n            if (_event.type !== 'location') {\n              _event.location = location;\n            }\n          }, obj);\n        }\n\n        const notInclude = ['location', 'identifier', 'identifiers'];\n        if (notInclude.indexOf(obj.type) === -1) {\n          _events.push(obj);\n        }\n\n        return obj;\n      });\n    }\n    return _events;\n  }, []);\n\n  events.sort(sortEventsByTimestamp);\n\n  return events;\n};\n\nexport const isLatest = (type) => {\n  return (['info', 'redirection', 'identifiers', 'branding', 'location'].indexOf(type) === -1);\n};\n\nexport const findEvent = (eventType, events) => {\n  let e = false;\n  events.map(event => {\n    if (event.content.data) {\n      event.content.data.map(obj => {\n        const type = obj.type.split('.');\n        obj.type = type[type.length - 1];\n        obj.type = obj.type.toLowerCase();\n\n        if (obj.type === 'location' || obj.type === 'identifiers') {\n          event.content.data.map(_obj => {\n            if (['location', 'identifiers'].indexOf(_obj.type) === -1) {\n              _obj[obj.type === 'location' ? 'location' : 'identifiers'] = obj;\n            }\n          });\n        }\n\n        switch (eventType) {\n          case 'latest':\n            if (isLatest(obj.type)) {\n              e = obj;\n            }\n            break;\n          default:\n            if (obj.type === eventType) {\n              e = obj;\n            }\n        }\n\n        return obj;\n      });\n    }\n\n    return event;\n  });\n\n  return e;\n};\n\nexport default {\n  validTimestamp,\n  checkTimeStamp,\n  parseEvents,\n  serializeParams,\n  serializeForHashing,\n  utf8Encode,\n  base64url,\n  checkAccessLevel,\n  getImage,\n  getLocation,\n  getName,\n  getUrlName,\n  sortEventsByTimestamp,\n  parseAsset,\n  parseEvent,\n  isLatest,\n  findEvent,\n  parseTimelineEvents,\n  timeSince,\n};","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Assets {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets/${encodeURIComponent(assetId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(params) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      this._request.postRequest('assets', params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Events {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events/${encodeURIComponent(eventId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, params) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      this._request.postRequest(`assets/${assetId}/events`, params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getBundleById(bundleId) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`bundle/${encodeURIComponent(bundleId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\n\nexport default class Accounts {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  addAccount(params) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      this._request.postRequest('accounts', params, true)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\nimport Assets from './api/assets';\nimport Events from './api/events';\nimport Accounts from './api/accounts';\nimport Utils, {\n  checkTimeStamp,\n  parseEvents,\n  serializeForHashing,\n  base64url,\n  checkAccessLevel,\n} from './utils';\nimport {\n  rejectResponse,\n  successResponse\n} from './responseHandler';\nlet assetSequenceNumber = 0;\n\nexport default class AmbrosusSDK {\n  constructor(extendSettings = {}) {\n    this.utils = Utils;\n    this._settings = {\n      apiEndpoint: 'https://gateway-test.ambrosus.com'\n    };\n    this.events = {};\n    this.empty = [];\n\n    if (typeof extendSettings === 'object') {\n      for (const key in extendSettings) {\n        if (extendSettings.hasOwnProperty(key)) {\n          this._settings[key] = extendSettings[key];\n        }\n      }\n\n      /* istanbul ignore if */\n      if (this._settings.Web3 && this._settings.secret) {\n        this.web3 = new this._settings.Web3();\n\n        if (this.web3.version.api) {\n          console.log('Old version of web3 is not supported, Please import v1.0.0+');\n        } else {\n          this._settings.address = this.getAddress(this._settings.secret);\n          this._settings.token = this.getToken(this._settings.secret);\n        }\n\n      } else if (this._settings.Web3) {\n        this.web3 = new this._settings.Web3();\n      }\n    } else {\n      return rejectResponse('SDK Init parameters should be an object');\n    }\n\n    this._assets = new Assets(this._settings);\n    this._events = new Events(this._settings);\n    this._accounts = new Accounts(this._settings);\n  }\n\n  calculateHash(data) {\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required get the token');\n    } else {\n      return this.web3.eth.accounts.hashMessage(serializeForHashing(data));\n    }\n  };\n\n  getToken(secret = null, timestamp) {\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required get the token');\n    } else if (!secret) {\n      if (!this._settings.secret) {\n        return rejectResponse('Secret key is required generate the token');\n      } else {\n        secret = this._settings.secret\n      }\n    }\n\n    /* istanbul ignore next */\n    const idData = {\n      createdBy: this.getAddress(secret),\n      validUntil: timestamp ? timestamp : Math.floor(Date.now() / 1000) + 300\n    };\n\n    /* istanbul ignore next */\n    return base64url(serializeForHashing({\n      signature: this.sign(idData, secret),\n      idData\n    }));\n  }\n\n  getAddress(secret = null) {\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required get the address');\n    } else if (!secret) {\n      if (!this._settings.secret) {\n        return rejectResponse('Secret key is required generate the address');\n      } else {\n        secret = this._settings.secret\n      }\n    }\n\n    /* istanbul ignore next */\n    return this.web3.eth.accounts.privateKeyToAccount(secret).address;\n  }\n\n  sign(data = {}, secret = null) {\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required generate a signature');\n    } else if (!secret) {\n      if (!this._settings.secret) {\n        return rejectResponse('Secret key is required generate a signature');\n      } else {\n        secret = this._settings.secret\n      }\n    }\n\n    /* istanbul ignore next */\n    return this.web3.eth.accounts.sign(serializeForHashing(data), secret).signature;\n  }\n\n  /**\n   * Returns object consisting of address & privateKey\n   * @returns {address, privateKey}\n   */\n  getPkPair() {\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required generate the publicKey / privateKey pair');\n    }\n    return this.web3.eth.accounts.create(this.web3.utils.randomHex(32));\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n      return this._assets.getAssetById(assetId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      if (!eventId) {\n        return reject(rejectResponse('Event ID is missing.'));\n      }\n\n      return this._events.getEventById(eventId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params = {}) {\n    return new Promise((resolve, reject) => {\n      return this._assets.getAssets(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      return this._events.getEvents(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(asset = {}) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n      let idData = {};\n\n      if (typeof asset !== 'object') {\n        return reject(rejectResponse('asset should be a json object or empty'));\n      } else if (!this.web3) {\n        return reject(rejectResponse('web3.js library is required to create an asset'));\n      } else if (!this._settings.secret) {\n        return reject(rejectResponse('Secret missing: Please initialize the SDK with your secret key'));\n      }\n\n      idData = {\n        timestamp: checkTimeStamp(asset),\n        sequenceNumber: assetSequenceNumber = (assetSequenceNumber + 1) % 1000000,\n        createdBy: this._settings.address\n      };\n\n      if (asset && asset.content && asset.content.data) {\n        idData['dataHash'] = this.web3.eth.accounts.hashMessage(serializeForHashing(asset.content.data));\n      }\n\n      let params = {\n        content: {\n          idData: idData,\n          signature: this.sign(idData, this._settings.secret)\n        }\n      };\n\n      if (params.content && params.content.idData && params.content.idData.dataHash) {\n        params.content['data'] = asset.content.data;\n      }\n\n      return this._assets.createAsset(params)\n        .then(assetRes => {\n          if (asset.length >= 1) {\n\n            asset.map((event) => {\n              return this.createEvent(assetRes.data.assetId, event)\n                .then(response => resolve(response))\n                .catch(error => reject(error));\n            });\n\n            this.emit('asset:created');\n            resolve(assetRes);\n          } else {\n            this.emit('asset:created');\n            resolve(assetRes);\n            return;\n          }\n        })\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, event) {\n    /* istanbul ignore next */\n    return new Promise((resolve, reject) => {\n\n      if (typeof event !== 'object') {\n        return reject(rejectResponse('event should be a json object'));\n      } else if (!this.web3) {\n        return reject(rejectResponse('web3.js library is required to create an event'));\n      } else if (!this._settings.secret) {\n        return reject(rejectResponse('Secret missing: Please initialize the SDK with your secret key'));\n      }\n\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n\n      if (!event) {\n        return reject(rejectResponse('Event data is missing.'));\n      }\n\n      let params = {};\n\n      if (event.content && event.content.data) {\n\n        const idData = {\n          assetId: assetId,\n          timestamp: checkTimeStamp(event),\n          accessLevel: checkAccessLevel(event),\n          createdBy: this._settings.address,\n          dataHash: this.web3.eth.accounts.hashMessage(serializeForHashing(event.content.data))\n        };\n\n        params = {\n          content: {\n            idData: idData,\n            signature: this.sign(idData, this._settings.secret),\n            data: event.content.data\n          }\n        };\n\n      } else {\n        return reject(rejectResponse('Invalid data: No content found at content.data.'));\n      }\n\n      return this._events.createEvent(assetId, params)\n        .then((response) => {\n          this.emit('event:created');\n          resolve(response);\n        })\n        .catch(error => reject(error));\n    });\n  }\n\n  parseEvents(eventsArray) {\n    return new Promise((resolve, reject) => {\n\n      if (eventsArray && eventsArray.results) {\n        return resolve(successResponse(parseEvents(eventsArray)));\n      }\n\n      return reject(rejectResponse('Results array is missing.'));\n\n    });\n  }\n\n  getBundleById(bundleId) {\n    return new Promise((resolve, reject) => {\n      if (!bundleId) {\n        return reject(rejectResponse('Bundle ID is missing.'));\n      }\n      /* istanbul ignore next */\n      return this._events.getBundleById(bundleId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  addAccount(params) {\n    return new Promise((resolve, reject) => {\n      if (!this._settings.secret) {\n        return reject(rejectResponse('Secret key is required to add an account.'));\n      }\n      /* istanbul ignore next */\n      else if (!params) {\n        return reject(rejectResponse('Create account params are required to create an account.'));\n      }\n      /* istanbul ignore next */\n      this.setTokenHeader(this._settings.secret);\n      /* istanbul ignore next */\n      return this._accounts.addAccount(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  setTokenHeader(secret = null) {\n    /* istanbul ignore next */\n    if (!this.web3) {\n      return rejectResponse('web3.js Library is required set the token');\n    } else if (!secret) {\n      if (!this._settings.secret) {\n        return rejectResponse('Secret key is required set the token');\n      } else {\n        secret = this._settings.secret\n      }\n    }\n\n    this._settings['headers'] = {\n      'Authorization': `AMB_TOKEN ${this.getToken(secret)}`\n    };\n\n  }\n\n  on(type, func, ctx) {\n    /* istanbul ignore next */\n    (this.events[type] = this.events[type] || []).push([func, ctx]);\n    /* istanbul ignore next */\n    return this;\n  }\n\n  off(type, func) {\n    /* istanbul ignore next */\n    type || (this.events = {});\n    let list = this.events[type] || this.empty;\n    let i = (list.length = func ? list.length : 0);\n\n    /* istanbul ignore next */\n    while (i--) {\n      func === list[i][0] && list.splice(i, 1);\n    }\n    /* istanbul ignore next */\n    return this;\n  }\n\n  emit(type) {\n    /* istanbul ignore next */\n    let e = this.events[type] || this.empty;\n    let list = e.length > 0 ? e.slice(0, e.length) : e;\n    let i = 0;\n    let j;\n\n    /* istanbul ignore next */\n    while ((j = list[i++])) {\n      j[0].apply(j[1], this.empty.slice.call(arguments, 1));\n    }\n    /* istanbul ignore next */\n    return this;\n  }\n}"],"names":["handleResponse","request","Promise","resolve","reject","const","response","status","data","message","JSON","parse","reason","rejectResponse","successResponse","Request","settings","_settings","getRequest","path","let","XMLHttpRequest","open","this","apiEndpoint","headers","key","setRequestHeader","addEventListener","then","catch","error","send","postRequest","params","hasHeader","onload","stringify","timeSince","date","Math","floor","seconds","Date","interval","validTimestamp","timestamp","getTime","checkTimeStamp","event","now","content","idData","parseEvents","eventsArray","results","reduce","asset","ref","author","createdBy","filter","obj","parts","type","split","length","category","namespace","name","action","eventId","_obj","_event","location","identifiers","map","indexOf","events","push","serializeParams","encodeURIComponent","serializeForHashing","object","subject","Array","isArray","Object","keys","sort","join","item","toString","utf8Encode","string","String","fromCharCode","replace","c","utftext","n","charCodeAt","_keyStr","base64url","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","isNaN","charAt","checkAccessLevel","accessLevel","getName","alternative","find","e","getUrlName","url","getImage","images","default","getLocation","city","country","sortEventsByTimestamp","a","b","parseEvent","info","toLowerCase","property","value","parseAsset","parseTimelineEvents","_events","ago","isLatest","findEvent","eventType","Assets","_request","getAssetById","assetId","getAssets","createAsset","this$1","Events","getEventById","getEvents","createEvent","getBundleById","bundleId","Accounts","addAccount","assetSequenceNumber","AmbrosusSDK","extendSettings","utils","Utils","empty","hasOwnProperty","Web3","secret","web3","version","api","console","log","address","getAddress","token","getToken","_assets","_accounts","calculateHash","eth","accounts","hashMessage","validUntil","signature","sign","privateKeyToAccount","getPkPair","create","randomHex","sequenceNumber","dataHash","assetRes","emit","setTokenHeader","on","func","ctx","off","list","splice","j","slice","apply","call","arguments"],"mappings":"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"}