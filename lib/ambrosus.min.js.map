{"version":3,"file":"ambrosus.min.js","sources":["../src/responseHandler.js","../src/api/request.js","../src/utils.js","../src/api/assets.js","../src/api/events.js","../src/api/auth.js","../src/index.js"],"sourcesContent":["/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const handleResponse = request => {\n  return new Promise((resolve, reject) => {\n    const response = {\n      status: request.status,\n      data: null,\n      message: JSON.parse(request.response).reason\n    };\n\n    if (request.status === 200 || request.status === 201) {\n      response.data = JSON.parse(request.response);\n      response.message = 'success';\n      resolve(response);\n    }\n    reject(response);\n  });\n};\n\nexport const rejectResponse = message => {\n  return {\n    status: 400,\n    data: null,\n    message: message\n  };\n};\n\nexport const successResponse = data => {\n  return {\n    status: 200,\n    data: data,\n    message: 'success'\n  };\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport { handleResponse } from './../responseHandler';\n\nexport default class Request {\n  constructor(settings) {\n    this._settings = settings;\n  }\n\n  getRequest(path) {\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open('GET', `${this._settings.apiEndpoint}/${path}`, true);\n      request.addEventListener(\n        'load',\n        () => {\n          handleResponse(request)\n            .then(response => resolve(response))\n            .catch(error => reject(error));\n        },\n        false\n      );\n      request.send();\n    });\n  }\n\n  postRequest(path, params) {\n    return new Promise((resolve, reject) => {\n      if (this._settings && this._settings.secret && this._settings.address) {\n        return reject({\n          status: 400,\n          data: null,\n          message: 'Secret key and account address are required for a state-modifying call'\n        });\n      }\n\n      let request = new XMLHttpRequest();\n\n      request.open('POST', `${this._settings.apiEndpoint}/${path}`, true, this._settings);\n      request.setRequestHeader('Content-type', 'application/json; charset=utf-8');\n      request.setRequestHeader('Authorization', 'AMB ' + this._settings.secret);\n\n      request.onload = () => {\n        handleResponse(request)\n          .then(response => resolve(response))\n          .catch(error => reject(error));\n      };\n\n      request.send(JSON.stringify(params));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nexport const checkTimeStamp = event => {\n  let timestamp = Math.floor(Date.now() / 1000);\n\n  return event.content && event.content.idData && event.content.idData.timestamp ? event.content.idData.timestamp : timestamp;\n};\n\nexport const parseEvents = eventsArray => {\n  return eventsArray.results.reduce(\n    (asset, { content, eventId }) => {\n      const timestamp = content.idData.timestamp;\n      const author = content.idData.createdBy;\n\n      if (content && content.data) {\n        content.data\n          .filter(obj => {\n            obj.timestamp = timestamp;\n            obj.author = author;\n            obj.name = obj.name || obj.type;\n            obj.action = obj.type;\n            obj.type = obj.type.substr(obj.type.lastIndexOf('.') + 1);\n            obj.for = obj.type.split('.')[1];\n            obj.eventId = eventId;\n\n            if (obj.type === 'location' && obj.for === 'event') {\n              content.data.reduce((location, _event) => {\n                if (_event.type !== 'location') {\n                  _event.location = location;\n                }\n              }, obj);\n            } else {\n              return obj;\n            }\n          })\n          .map(event => {\n            if (['info', 'redirection', 'identifiers', 'branding'].indexOf(event.type) > -1) {\n              if (!asset[event.type] || asset[event.type].timestamp < event.timestamp) {\n                asset[event.type] = event;\n              }\n            } else {\n              asset.events.push(event);\n            }\n          });\n      }\n\n      return asset;\n    },\n    {\n      events: []\n    }\n  );\n};\n\nexport const serializeParams = params => {\n  let serializeParams = '';\n\n  for (let key in params) {\n    if (serializeParams !== '') {\n      serializeParams += '&';\n    }\n    serializeParams += key + '=' + encodeURIComponent(params[key]);\n  }\n  return serializeParams;\n};\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Assets {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets/${encodeURIComponent(assetId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`assets?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest('assets', params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\nimport { serializeParams } from './../utils';\n\nexport default class Events {\n  constructor(settings, auth) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events/${encodeURIComponent(eventId)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      this._request.getRequest(`events?${serializeParams(params)}`)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, params) {\n    return new Promise((resolve, reject) => {\n      this._request.postRequest(`assets/${assetId}/events`, params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Request from './request';\n\nexport default class Auth {\n  constructor(settings) {\n    this._settings = settings;\n    this._request = new Request(this._settings);\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      this._request\n        .postRequest('token', params)\n        .then(response => {\n          resolve(response);\n        })\n        .catch(error => reject(error));\n    });\n  }\n}\n","/*\nCopyright: Ambrosus Technologies GmbH\nEmail: tech@ambrosus.com\nThis Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.\nIf a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\nThis Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.\n*/\n\nimport Assets from './api/assets';\nimport Events from './api/events';\nimport Auth from './api/auth';\nimport { checkTimeStamp, parseEvents } from './utils';\nimport { rejectResponse, successResponse } from './responseHandler';\n\nexport default class AmbrosusSDK {\n  constructor(extendSettings) {\n    this._settings = {\n      apiEndpoint: 'https://gateway-test.ambrosus.com'\n    };\n    this.events = {};\n    this.empty = [];\n\n    for (const key in extendSettings) {\n      if (extendSettings.hasOwnProperty(key)) {\n        this._settings[key] = extendSettings[key];\n      }\n    }\n\n    this._auth = new Auth(this._settings);\n    this._assets = new Assets(this._settings, this._auth);\n    this._events = new Events(this._settings, this._auth);\n  }\n\n  getAssetById(assetId) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n      return this._assets.getAssetById(assetId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEventById(eventId) {\n    return new Promise((resolve, reject) => {\n      if (!eventId) {\n        return reject(rejectResponse('Event ID is missing.'));\n      }\n\n      return this._events.getEventById(eventId)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getAssets(params = {}) {\n    return new Promise((resolve, reject) => {\n      return this._assets.getAssets(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  getEvents(params) {\n    return new Promise((resolve, reject) => {\n      return this._events.getEvents(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  createAsset(asset = {}) {\n    return new Promise((resolve, reject) => {\n\n      let params = {\n        content: {\n          idData: {\n            createdBy: this._settings.address,\n            timestamp: checkTimeStamp(asset),\n            sequenceNumber: 0\n          }\n        }\n      };\n\n      if (asset.data) {\n        params['data'] = asset.data;\n      }\n\n      return this._assets.createAsset(params)\n        .then(assetRes => {\n          if (asset.length >= 1) {\n            let finalEventResponse = [];\n\n            for (let i = 0; i < asset.length; i++) {\n              finalEventResponse[i] = new Promise((resolve, reject) => {\n                return this.createEvent(assetRes.data.assetId, asset[i]).then(eventRes => {\n                  resolve(eventRes);\n                });\n              });\n            }\n            this.emit('asset:created');\n            resolve(assetRes);\n          } else {\n            this.emit('asset:created');\n            resolve(assetRes);\n            return;\n          }\n        })\n        .catch(error => reject(error));\n    });\n  }\n\n  createEvent(assetId, event) {\n    return new Promise((resolve, reject) => {\n      if (!assetId) {\n        return reject(rejectResponse('Asset ID is missing.'));\n      }\n\n      if (!event) {\n        return reject(rejectResponse('Event data is missing.'));\n      }\n\n      let params = {\n        content: {\n          idData: {\n            assetId: assetId,\n            timestamp: checkTimeStamp(event),\n            accessLevel: 0,\n            createdBy: this._settings.address\n          }\n        }\n      };\n\n      if (event.content && event.content.data) {\n        params.content['data'] = event.content.data;\n      } else {\n        return reject(rejectResponse('Invalid data: No content found at content.data.'));\n      }\n\n      return this._events.createEvent(assetId, params)\n        .then((response) => { this.emit('event:created'); resolve(response); })\n        .catch(error => reject(error));\n    });\n  }\n\n  parseEvents(eventsArray) {\n    return new Promise((resolve, reject) => {\n\n      if (eventsArray && eventsArray.results) {\n        return resolve(successResponse(parseEvents(eventsArray)));\n      }\n\n      return reject(rejectResponse('Results array is missing.'));\n\n    });\n  }\n\n  getToken(params) {\n    return new Promise((resolve, reject) => {\n      if (!params && !params.validUntil) {\n        return reject(rejectResponse('Invalid data: Unix timestamp was not provided or has an invalid format'));\n      }\n      this._auth.getToken(params)\n        .then(response => resolve(response))\n        .catch(error => reject(error));\n    });\n  }\n\n  on(type, func, ctx) {\n    (this.events[type] = this.events[type] || []).push([func, ctx]);\n    return this;\n  }\n\n  off(type, func) {\n    type || (this.events = {});\n    let list = this.events[type] || this.empty;\n    let i = (list.length = func ? list.length : 0);\n\n    while (i--) {\n      func === list[i][0] && list.splice(i, 1);\n    }\n    return this;\n  }\n\n  emit(type) {\n    let e = this.events[type] || this.empty;\n    let list = e.length > 0 ? e.slice(0, e.length) : e;\n    let i = 0;\n    let j;\n\n    while ((j = list[i++])) {\n      j[0].apply(j[1], this.empty.slice.call(arguments, 1));\n    }\n    return this;\n  }\n\n}\n"],"names":["handleResponse","request","Promise","resolve","reject","const","response","status","data","message","JSON","parse","reason","rejectResponse","successResponse","Request","settings","_settings","getRequest","path","let","XMLHttpRequest","open","this","apiEndpoint","addEventListener","then","catch","error","send","postRequest","params","secret","address","setRequestHeader","onload","stringify","checkTimeStamp","event","timestamp","Math","floor","Date","now","content","idData","parseEvents","eventsArray","results","reduce","asset","ref","author","createdBy","filter","obj","name","type","action","substr","lastIndexOf","for","split","eventId","location","_event","map","indexOf","events","push","serializeParams","key","encodeURIComponent","Assets","_request","getAssetById","assetId","getAssets","createAsset","this$1","Events","getEventById","getEvents","createEvent","Auth","getToken","AmbrosusSDK","extendSettings","empty","hasOwnProperty","_auth","_assets","_events","sequenceNumber","assetRes","length","finalEventResponse","i","eventRes","emit","accessLevel","validUntil","on","func","ctx","off","list","splice","j","e","slice","apply","call","arguments"],"mappings":"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"}